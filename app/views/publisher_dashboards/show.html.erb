<% content_for :breadcrumbs do %>
  <%= render "/@shared/breadcrumbs/dashboard", class: "active" %>
<% end %>

<% content_for :actions do %>
  <%= render "/@shared/date_range_picker" %>
<% end %>

<% content_for :page_heading do %>
  <%= page_heading "Publisher", "Dashboard",
    subtitle: "Overall view of your account",
    icon: "fas fa-tachometer" %>
<% end %>

<main id="content" role="main" class="bg-light">
  <div class="container space-1">

    <div class="card-deck d-block d-lg-flex card-lg-gutters-3 mb-3">
      <%= render "/@shared/widgets/stat_card",
        label: "Impressions",
        value: number_with_delimiter(current_user.impressions_as_publisher.between(@start_date, @end_date).count) %>
      <%= render "/@shared/widgets/stat_card",
        label: "Clicks",
        value: number_with_delimiter(current_user.impressions_as_publisher.clicked.between(@start_date, @end_date).count) %>
      <%= render "/@shared/widgets/stat_card",
        label: "CTR",
        value: "TBD" %> <%# TODO: Nate - Average CTR for date range and publisher (start_date to end_date) %>
      <%= render "/@shared/widgets/stat_card",
        label: "Earnings",
        value: number_to_currency(current_user.earned_revenue(@start_date, @end_date)) %> <%# TODO: Nate - Average calculated CPC for date range and publisher (start_date to end_date) %>
    </div>

    <div class="text-center mb-3 mt-5">
      <span class="u-divider u-divider--xs u-divider--text">Active Properties</span>
    </div>

    <div class="mb-3">
      <div class="card-deck d-block d-md-flex card-sm-columns card-sm-2-count card-md-3-count">
        <%= render partial: "/properties/card",
          collection: @properties,
          locals: { start_date: @start_date, end_date: @end_date }, as: :property %>
      </div>
    </div>

  </div>
</main>